/*! angular-yahoo-pipes - v0.1.0 - 2014-11-26
* Copyright (c) 2014 Dmytro Yarmak <dmytroyarmak@gmail.com>; Licensed MIT */
"use strict";angular.module("dyYahooPipes",[]),angular.module("dyYahooPipes").constant("DY_YAHOO_PIPES_URL_PATTERN","http://pipes.yahoo.com/pipes/pipe.run?_render=json&_id=PIPE_ID"),angular.module("dyYahooPipes").constant("DY_YAHOO_PIPES_DEFAULT_COUNT",10),angular.module("dyYahooPipes").constant("DY_YAHOO_PIPES_PARSE_FUNCTIONS",{title:function(a){return a.title},description:function(a){return a.description.replace(/(<([^>]+)>)/gi,"").replace(/(&[^;]+;)/gi,"").replace("Read More","")},link:function(a){return a.link},imageUrl:function(a){var b=a["media:thumbnail"],c=angular.isArray(b)?b[0]:b;return c.url}}),angular.module("dyYahooPipes").factory("dyYahooPipesParser",["DY_YAHOO_PIPES_PARSE_FUNCTIONS",function(a){return{parseItem:function(b){return Object.keys(a).reduce(function(c,d){return c[d]=a[d](b),c},{})},parseResponseData:function(a,b){var c;return a.value&&a.value.items?(c=a.value.items.slice(0,b),c.map(this.parseItem)):[]}}}]),angular.module("dyYahooPipes").factory("dyYahooPipesFetcher",["$http","$q","DY_YAHOO_PIPES_URL_PATTERN","DY_YAHOO_PIPES_DEFAULT_COUNT","dyYahooPipesParser",function(a,b,c,d,e){return{fetch:function(b,f){var g=c.replace("PIPE_ID",b);return a.get(g).then(function(a){return e.parseResponseData(a.data,f||d)})}}}]),angular.module("dyYahooPipes").directive("dyYahooPipes",function(){return{restrict:"E",replace:!0,templateUrl:"angular-yahoo-pipes.tpl.html",scope:{pipeId:"@",loadingText:"@",emptyText:"@",linkText:"@",count:"@"},controller:["$scope","dyYahooPipesFetcher",function(a,b){a.styleFor=function(a){return{"background-image":"url("+a.imageUrl+")"}},a.isActive=function(b){return a.active===b},a.setActive=function(b){a.active=b},a.isLoading=function(){return null==a.items},a.isEmpty=function(){return a.items&&!a.items.length},b.fetch(a.pipeId,a.count).then(function(b){a.items=b})}]}}),angular.module("dyYahooPipes").run(["$templateCache",function(a){a.put("angular-yahoo-pipes.tpl.html",'<div class="dy-yahoo-pipes" ng-class="{\'is-loading\': isLoading(), \'is-empty\': isEmpty()}">\r\n\r\n  <div ng-if="!isLoading() && isEmpty()">\r\n    <p class="dy-yahoo-pipes-notice">{{emptyText || \'There are no items in current pipe...\'}}</p>\r\n  </div>\r\n\r\n  <div ng-if="isLoading()">\r\n    <p class="dy-yahoo-pipes-notice">{{loadingText || \'Pipe is beeing loaded...\'}}</p>\r\n  </div>\r\n\r\n  <div\r\n    class="dy-yahoo-pipes-item"\r\n    ng-style="styleFor(item)"\r\n    ng-class="{\'is-active\': isActive(item)}"\r\n    ng-click="setActive(item)"\r\n    ng-repeat="item in items"\r\n  >\r\n    <h3 class="dy-yahoo-pipes-item-title">{{item.title}}</h3>\r\n    <p class="dy-yahoo-pipes-item-description">{{item.description}}</p>\r\n    <a class="dy-yahoo-pipes-item-link" ng-href="{{item.link}}">{{linkText || \'Read more...\'}}</a>\r\n  </div>\r\n</div>\r\n')}]);